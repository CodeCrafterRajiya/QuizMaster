@model IEnumerable<quezemasterNew.Models.ViewModel.QuezIndex20DetailsViewModel>

@{
    ViewData["Title"] = "Create";
}


<style>
    #dataTable_filter, #dataTable_length, #dataTable_info, #dataTable_paginate {
        display: block;
        border: 1px solid black;
    }

    .table {
        border: 1px solid black;
    }

        .table thead th {
            border-bottom: 1px solid black;
        }

    button.dt-button, div.dt-button, a.dt-button, input.dt-button {
        background-color: #EC6BAB;
        color: white;
    }

</style>
<script>
    var $jq = jQuery.noConflict();
    $jq(document).ready(function () {
        var printCounter = 0;
        $jq('#ConfirmTable').DataTable({
            dom: 'Bfrtip',
            buttons: [

                {
                    extend: 'excel',
                    messageTop: 'Quize Index'
                },

                {
                    extend: 'print',
                    messageTop: function () {
                        printCounter++;

                        if (printCounter === 1) {
                            return '<center><h3><u>Quize Index</u></h3></center><hr/>';
                        }
                        else {
                            return '<center><h3><u>Quize Index</u></h3></center><hr/>';
                        }
                    },
                    messageBottom: null
                }
            ]
        });
    });
</script>
@* <p>
    <a asp-action="Create" class="btn btn-primary ButtonTheam">Create New</a>
</p> *@

<!--Show alert message using bootstrp sweet modal--->
<div class="alert  alert-dismissible  custom-alert" id="customMessageAlert" role="alert">
    <span class="alert-text"></span>
    <span class="close-btn float-end" id="closeBtn" aria-label="Close">&times;</span>
</div>

<div class="table-responsive">
<table id="ConfirmTable" class="table table-responsive table table-bordered table-hover text-center average-font-size" border="1">
    @{
        <thead>
            <tr>
                <th>
                    <label>#</label>
                </th>
                <th>
                    @Html.DisplayNameFor(model => model.QuezName)
                </th>
                <th>
                    @Html.DisplayNameFor(model => model.ClassName)
                </th>
                <th>
                    @Html.DisplayNameFor(model => model.SubjectName)
                </th>

                <th>Action</th>
            </tr>
        </thead>
        var i = 1;
        <tbody>
            @foreach (var item in Model)
            {
                <tr>
                    <td data-label="#">
                        @Html.Label(""+i++.ToString())
                    </td>
                    <td data-label="Quez Name">
                        @Html.DisplayFor(modelItem => item.QuezName)
                    </td>
                    <td data-label="Class Name">
                        @Html.DisplayFor(modelItem => item.ClassName)
                    </td>
                    <td data-label="Subject Name">
                        @Html.DisplayFor(modelItem => item.SubjectName)
                    </td>
         

                    <td data-label="Action">
                        <div class="dropdown text-center average-font-size">
                            <span class="btn-sm" data-bs-toggle="dropdown" aria-expanded="false" style="cursor:pointer;">
                                <svg width="18" height="18" fill="currentColor" class="bi bi-three-dots-vertical" viewBox="0 0 16 16">
                                    <path d="M9.5 13a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0z" />
                                </svg>
                            </span>

                            <ul class="dropdown-menu bg-body p-0">
                                <li>
                                    <a asp-action="Index" asp-controller="QuestionPepar" asp-route-id="@item.Id" data-id="@item.Id" class="dropdown-item p-2 ps-3   GneralApptitudeUPPQuestionPaper">
                                        Question
                                    </a>
                                </li>

                                <li>
                                    <a class="dropdown-item p-2 ps-3 EditGneralApptitudeUPP" data-id="@item.Id">
                                        Edit
                                    </a>
                                </li>

                                <li>
                                    <a class="dropdown-item p-2 ps-3 text-danger btn-drop-delete DeleteGneralApptitudeUPP" data-id="@item.Id">
                                        Delete
                                    </a>
                                </li>
                            </ul>
                        </div>
                    </td>


                </tr>
            }
        </tbody>
    }
</table> 
</div>
 <script>
      var $jq = jQuery.noConflict();

    $jq(document).ready(function () {
 

         var errorMessage = '@ViewData["QuezGAUPPResult"]';
        console.log("msg :"+errorMessage);
        if(errorMessage!=null && errorMessage!="")
        {
           if(errorMessage ==="SaveSuccess")
              showMessageToUser('customMessageAlert', "Your data has been successfully saved.", "success");
           else if(errorMessage ==="SaveError")
              showMessageToUser('customMessageAlert',"We apologize, but an error occurred while saving the data.", "error");
           else if(errorMessage==="UpdateSuccess")
                showMessageToUser('customMessageAlert', "Your data has been successfully update.", "success");
           else if(errorMessage ==="UpdateError")
              showMessageToUser('customMessageAlert',"We apologize, but an error occurred while updating the data.", "error");
           else if(errorMessage ==="DeleteSuccess")
               showMessageToUser('customMessageAlert',"Your data has been successfully deleted.", "success");
           else if(errorMessage ==="DeleteError")
              showMessageToUser('customMessageAlert',"We apologize, but an error occurred while deleting the data.", "error");
        }



        $jq('#ConfirmTable').on('click', '.DeleteGneralApptitudeUPP', function () {
            // Disable the button to prevent multiple clicks
            $jq(this).prop('disabled', true);
            if (!confirm("Are you sure you want to delete this?")) {
                // Re-enable the button if the user cancels the action
                $jq(this).prop('disabled', false);
                return false;
            }
            else {
           // Get the ID from clicked button
            var id = $jq(this).data('id');
          //  console.log("Clicked ID:", id);

                $jq.ajax({
                    type: 'POST',
                    url: '@Url.Action("Delete", "QuezIndex10Detail")',
                    data: { UPPId: id },
                    success: function (data) {
                        if (data.length > 0) {
                            // Retrieve the ViewData value and ensure it's a string
                            $jq("#GAUPPList").html('');
                            $jq("#GAUPPList").html(data);
                        }
                        // Re-enable the button after the process is complete
                        $jq('.DeleteGneralApptitudeUPP').prop('disabled', false);
                    },
                    error: function (error) {
                        console.log(error);

                        showMessageToUser('customMessageAlert',"We apologize, but an error occurred while deleting the data.", "error");

                        // Re-enable the button if an error occurs
                        $jq('.DeleteGneralApptitudeUPP').prop('disabled', false);
                    }

                });

            }
        });



        //code for Edit data
        $jq('#ConfirmTable').on('click', '.EditGneralApptitudeUPP', function () {
        // Get the ID from clicked button
          var id = $jq(this).data('id');
         // console.log("Clicked ID:", id);

          // Disable the button to prevent multiple clicks
          $jq(this).prop('disabled', true);
    
            $jq.ajax({
                type: 'POST',
                url: '@Url.Action("EditGeneralAptitudeUPPData", "QuezIndex10Detail")',
                data: { UPPId: id },
                success: function (data) {
                    if (data.length > 0) {
                        $jq("#GAUPPForm").html('');
                        $jq("#GAUPPForm").replaceWith(data);
                  
                    }
                    // Re-enable the button after the process is complete
                    $jq('.EditGneralApptitudeUPP').prop('disabled', false);
                },
                error: function (error) {
                    console.log(error);
                    // Re-enable the button if an error occurs
                    $jq('.EditGneralApptitudeUPP').prop('disabled', false);
                }

            });

        });





         $jq('#customMessageAlert').on('click', '#closeBtn', function () {
            setupAlertClose('customMessageAlert', 1000);
         });



    });




 </script>